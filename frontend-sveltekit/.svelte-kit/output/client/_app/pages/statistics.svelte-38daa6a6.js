import{X as a,Y as s,S as t,i as e,s as r,j as c,m as l,o as n,x as o,u as i,v as d,Z as u,A as f,e as m,c as p,a as h,d as g,b as $,_ as v,f as b,F as y,$ as E,Q as D,t as I,g as w,h as V,J as _,k,n as C,a0 as S,r as j,w as x,a1 as A,a2 as L,a3 as N}from"../chunks/vendor-64f8909b.js";import{c as O,g as T}from"../chunks/config-e02f87b3.js";import{s as B,u as P,a as U,C as M,M as R}from"../chunks/Message-d50c0ec1.js";import{L as q}from"../chunks/Loading-bfbc499b.js";import"../chunks/singletons-12a22614.js";const z=O.API_URL_PROD;function F(a,s,t){const e=a.slice();return e[12]=s[t],e}function H(a){let s,t,e,r,c,l=a[4].data,n=[];for(let o=0;o<l.length;o+=1)n[o]=J(F(a,l,o));return{c(){s=m("div"),t=m("div"),e=m("select");for(let a=0;a<n.length;a+=1)n[a].c();this.h()},l(a){s=p(a,"DIV",{class:!0});var r=h(s);t=p(r,"DIV",{class:!0});var c=h(t);e=p(c,"SELECT",{class:!0,"aria-label":!0});var l=h(e);for(let s=0;s<n.length;s+=1)n[s].l(l);l.forEach(g),c.forEach(g),r.forEach(g),this.h()},h(){$(e,"class","form-select"),e.multiple=!0,$(e,"aria-label","multiple select pages"),void 0===a[3]&&v((()=>a[10].call(e))),$(t,"class","col"),$(s,"class","row mb-3")},m(l,o){b(l,s,o),y(s,t),y(t,e);for(let a=0;a<n.length;a+=1)n[a].m(e,null);E(e,a[3]),r||(c=D(e,"change",a[10]),r=!0)},p(a,s){if(16&s){let t;for(l=a[4].data,t=0;t<l.length;t+=1){const r=F(a,l,t);n[t]?n[t].p(r,s):(n[t]=J(r),n[t].c(),n[t].m(e,null))}for(;t<n.length;t+=1)n[t].d(1);n.length=l.length}24&s&&E(e,a[3])},d(a){a&&g(s),_(n,a),r=!1,c()}}}function J(a){let s,t,e,r=a[12]+"";return{c(){s=m("option"),t=I(r),this.h()},l(a){s=p(a,"OPTION",{});var e=h(s);t=w(e,r),e.forEach(g),this.h()},h(){s.__value=e=a[12],s.value=s.__value},m(a,e){b(a,s,e),y(s,t)},p(a,c){16&c&&r!==(r=a[12]+"")&&V(t,r),16&c&&e!==(e=a[12])&&(s.__value=e,s.value=s.__value)},d(a){a&&g(s)}}}function Q(a){let s,t;return s=new q({props:{number:3,color:"primary"}}),{c(){c(s.$$.fragment)},l(a){l(s.$$.fragment,a)},m(a,e){n(s,a,e),t=!0},i(a){t||(o(s.$$.fragment,a),t=!0)},o(a){i(s.$$.fragment,a),t=!1},d(a){d(s,a)}}}function W(a){let s,t;return s=new R({props:{color:a[0].success?"primary":"danger",$$slots:{default:[X]},$$scope:{ctx:a}}}),{c(){c(s.$$.fragment)},l(a){l(s.$$.fragment,a)},m(a,e){n(s,a,e),t=!0},p(a,t){const e={};1&t&&(e.color=a[0].success?"primary":"danger"),32769&t&&(e.$$scope={dirty:t,ctx:a}),s.$set(e)},i(a){t||(o(s.$$.fragment,a),t=!0)},o(a){i(s.$$.fragment,a),t=!1},d(a){d(s,a)}}}function X(a){let s,t=a[0].message+"";return{c(){s=I(t)},l(a){s=w(a,t)},m(a,t){b(a,s,t)},p(a,e){1&e&&t!==(t=a[0].message+"")&&V(s,t)},d(a){a&&g(s)}}}function Y(a){let s,t,e,r,c,l,n,d,u,f,v,E,V,_,L,N,O,T,B,P,U,M,R,q,z,F,J,X,Y,Z,G,K=a[4].data&&H(a),aa=a[0].loading&&Q(),sa=a[0].message&&W(a);return{c(){s=m("h1"),t=I("Statistics"),e=k(),r=m("form"),c=m("div"),l=m("div"),n=m("label"),d=I("Date de début"),u=k(),f=m("input"),v=k(),E=m("div"),V=m("label"),_=I("Date de fin"),L=k(),N=m("input"),O=k(),K&&K.c(),T=k(),B=m("div"),P=m("div"),U=m("button"),M=I("Valider"),R=k(),aa&&aa.c(),q=k(),sa&&sa.c(),z=k(),F=m("div"),J=m("div"),X=m("canvas"),this.h()},l(a){s=p(a,"H1",{class:!0});var o=h(s);t=w(o,"Statistics"),o.forEach(g),e=C(a),r=p(a,"FORM",{id:!0,class:!0});var i=h(r);c=p(i,"DIV",{class:!0});var m=h(c);l=p(m,"DIV",{class:!0});var $=h(l);n=p($,"LABEL",{for:!0,class:!0});var b=h(n);d=w(b,"Date de début"),b.forEach(g),u=C($),f=p($,"INPUT",{type:!0,class:!0,id:!0}),$.forEach(g),v=C(m),E=p(m,"DIV",{class:!0});var y=h(E);V=p(y,"LABEL",{for:!0,class:!0});var D=h(V);_=w(D,"Date de fin"),D.forEach(g),L=C(y),N=p(y,"INPUT",{type:!0,class:!0,id:!0}),y.forEach(g),m.forEach(g),O=C(i),K&&K.l(i),T=C(i),B=p(i,"DIV",{class:!0});var I=h(B);P=p(I,"DIV",{class:!0});var k=h(P);U=p(k,"BUTTON",{type:!0,class:!0});var S=h(U);M=w(S,"Valider"),S.forEach(g),k.forEach(g),I.forEach(g),i.forEach(g),R=C(a),aa&&aa.l(a),q=C(a),sa&&sa.l(a),z=C(a),F=p(a,"DIV",{class:!0});var j=h(F);J=p(j,"DIV",{class:!0});var x=h(J);X=p(x,"CANVAS",{id:!0}),h(X).forEach(g),x.forEach(g),j.forEach(g),this.h()},h(){$(s,"class","mt-2"),$(n,"for","startDateInput"),$(n,"class","form-label"),$(f,"type","date"),$(f,"class","form-control"),$(f,"id","startDateInput"),f.required=!0,$(l,"class","col-sm-12 col-md-6"),$(V,"for","endDateInput"),$(V,"class","form-label"),$(N,"type","date"),$(N,"class","form-control"),$(N,"id","endDateInput"),N.required=!0,$(E,"class","col-sm-12 col-md-6"),$(c,"class","row align-items-center mb-3"),$(U,"type","submit"),$(U,"class","btn btn-primary"),$(P,"class","col text-start"),$(B,"class","row"),$(r,"id","statistics"),$(r,"class","statistics-form"),$(X,"id","statisticsChart"),$(J,"class","col bg-light rounded p-5"),$(F,"class","row my-3")},m(o,i){b(o,s,i),y(s,t),b(o,e,i),b(o,r,i),y(r,c),y(c,l),y(l,n),y(n,d),y(l,u),y(l,f),S(f,a[1]),y(c,v),y(c,E),y(E,V),y(V,_),y(E,L),y(E,N),S(N,a[2]),y(r,O),K&&K.m(r,null),y(r,T),y(r,B),y(B,P),y(P,U),y(U,M),b(o,R,i),aa&&aa.m(o,i),b(o,q,i),sa&&sa.m(o,i),b(o,z,i),b(o,F,i),y(F,J),y(J,X),Y=!0,Z||(G=[D(f,"input",a[8]),D(N,"input",a[9]),D(r,"submit",a[5])],Z=!0)},p(a,s){2&s&&S(f,a[1]),4&s&&S(N,a[2]),a[4].data?K?K.p(a,s):(K=H(a),K.c(),K.m(r,T)):K&&(K.d(1),K=null),a[0].loading?aa?1&s&&o(aa,1):(aa=Q(),aa.c(),o(aa,1),aa.m(q.parentNode,q)):aa&&(j(),i(aa,1,1,(()=>{aa=null})),x()),a[0].message?sa?(sa.p(a,s),1&s&&o(sa,1)):(sa=W(a),sa.c(),o(sa,1),sa.m(z.parentNode,z)):sa&&(j(),i(sa,1,1,(()=>{sa=null})),x())},i(a){Y||(o(aa),o(sa),Y=!0)},o(a){i(aa),i(sa),Y=!1},d(a){a&&g(s),a&&g(e),a&&g(r),K&&K.d(),a&&g(R),aa&&aa.d(a),a&&g(q),sa&&sa.d(a),a&&g(z),a&&g(F),Z=!1,A(G)}}}function Z(a){let s,t;return s=new M({props:{$$slots:{default:[Y]},$$scope:{ctx:a}}}),{c(){c(s.$$.fragment)},l(a){l(s.$$.fragment,a)},m(a,e){n(s,a,e),t=!0},p(a,[t]){const e={};32799&t&&(e.$$scope={dirty:t,ctx:a}),s.$set(e)},i(a){t||(o(s.$$.fragment,a),t=!0)},o(a){i(s.$$.fragment,a),t=!1},d(a){d(s,a)}}}function G(t,e,r){let c,l,n;u(t,B,(a=>r(0,c=a))),u(t,P,(a=>r(7,l=a))),u(t,U,(a=>r(4,n=a)));let o,i=new Date(Date.now()).toISOString().substring(0,10),d=new Date(Date.now()).toISOString().substring(0,10),m=null,p=[];f((()=>{(async()=>{try{U.set({loading:!0,success:!1,message:"",data:[]});const t={headers:{"Content-type":"application/json",Authorization:`Bearer ${a(P).token}`}},{data:e}=await s.get(`${z}/api/statistics/params`,t);U.set({loading:!1,success:!0,message:"success",data:e.data})}catch(t){U.set({loading:!1,success:!1,message:"error : "+t,data:[]})}})(),m=document.getElementById("statisticsChart").getContext("2d"),r(6,o=new L(m,{type:"line",data:{labels:[],datasets:[{label:"# of Views",data:[],backgroundColor:[],borderColor:[],borderWidth:1}]}}))}));return t.$$.update=()=>{if(128&t.$$.dirty){!(!l||"admin"!==l.profil)||T("/")}65&t.$$.dirty&&c.success&&(r(6,o.data=c.data,o),o.update())},[c,i,d,p,n,t=>{!1===t.currentTarget.checkValidity()||(t.preventDefault(),(async(t,e,r)=>{try{B.set({loading:!0,message:"",data:null});const c={headers:{"Content-type":"application/json",Authorization:`Bearer ${a(P).token}`}},{data:l}=await s.get(`${z}/api/statistics?start=${t}&end=${e}&pages=${r}`,c);B.set({loading:!1,success:!0,message:"success",data:l.data})}catch(c){B.set({loading:!1,success:!1,message:"Error fetching statistics "+c,data:null})}})(i,d,p.join("-SEP-")))},o,l,function(){i=this.value,r(1,i)},function(){d=this.value,r(2,d)},function(){p=N(this),r(3,p)}]}class K extends t{constructor(a){super(),e(this,a,G,Z,r,{})}}export{K as default};
